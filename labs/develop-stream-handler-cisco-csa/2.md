### Section B: Writing the customized CSA Handler and configurations

<b>Step 8:</b> <b>Select CSA customize handler "wksp-csa-handler"</b> and click on <b>"Launch"</b>
![Figure](https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/develop-stream-handler-cisco-csa/assets/images/CSAWorkSpaceSelection.PNG?raw=true)

On clicking on <b>Launch</b> button, the IDE will be launched based on workspace.
![Figure](https://github.com/prakdutt/data-dev-learning-labs/blob/master/labs/develop-stream-handler-cisco-csa/assets/images/csa-IDE.PNG?raw=true)

<b>Step 9:</b> All the basic configurations are written in “include-handler.xml” file. Find this file in below location: <b>CsaCustomHandler-->build-->tmp-->include-handler.xml.</b> Double click on it and open it in right panel.<br>

![Figure](https://github.com/prakdutt/data-dev-learning-labs/blob/master/labs/develop-stream-handler-cisco-csa/assets/images/csa-includehandler.PNG?raw=true)

<b>Step 10:</b> In the “include-handler.xml” file set the kafka Topic and Kafka Zookeeper IP and Port and change the name of the custom class which we are going to develop. Here handler java class name is ETLHandler.java.

```
	<topic>CiscoDDP</topic>     // Change the Kafka Topic here.
	<arguments>
 		<arg name="zookeeper.connect">172.16.11.10:2181/kafka</arg>  //Configure IP & Port
	</arguments>
	<custom class="custom.handlers.ETLHandler” </custom>        
	//Set the Handler Java Class which we are going to code next step
```

<b>Step 11 :</b> Sample Java class for CSA handler is placed in below path. Here we named it as ETLHandler.<br>
<b>CsaCustomHandler --> customizations --> src --> ETLHandler.java </b>

![alt-tag](https://github.com/prakdutt/data-dev-learning-labs/blob/master/labs/develop-stream-handler-cisco-csa/assets/images/ETLHandlerClass.PNG?raw=true)

<b><u>Sample Coding Exercise</u></b><br>

```
package custom.handlers;

import org.apache.commons.configuration.SubnodeConfiguration;
import com.cisco.pa.handlers.model.DataRecord;
import com.truviso.system.handlers.AbstractEntryHanlder;
import com.truviso.system.handlers.HandlerException;

public class ETLHandler extends AbstractEntryHanlder<DataRecord, DataRecord> {
	String string;
	public ETLHandler(SubnodeConfiguration c) {
		super(c);
	}
	@Override
	public void init() throws HandlerException {
		super.init();
        try {
        	string = config.getString("string", "POST");
               } catch (IllegalArgumentException e) {}
	}
	@Override
	public void handle(DataRecord record) throws HandlerException {

		try {
			if (null != record) {
				if (record.toString().contains(string))
					resultListener.handle(record);
			}

		      } catch (Exception ex) {throw new HandlerException(ex);}}}
```



<b>Step 12:</b> Above Truecq IP and Port number details are required to set the handler. We need to update the configuration file.<br> Open the IDE and double click on the below file

<b>CsaCustomHandler-->customizations-->instances-->local-runtime.properties</b></br>
We will get the Trucq port number from <b>Step 7</b>

![Figure](https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/develop-stream-handler-cisco-csa/assets/images/aaaaa.png?raw=true)

<b>Step 13:</b>In this step we need to stop the handler first. In the top of the IDE we can select stop from the combo. 
![Figure](https://github.com/prakdutt/data-dev-learning-labs/blob/master/labs/develop-stream-handler-cisco-csa/assets/images/step13.jpg?raw=true)

<b>Step 14:</b>In this step we need to build our handler. In the top of the IDE we can select build from the combo.
![Figure](https://github.com/prakdutt/data-dev-learning-labs/blob/master/labs/develop-stream-handler-cisco-csa/assets/images/step14.jpg?raw=true)

<b>Step 15:</b>In this step we need to Start our handler to select Run. In the top of the IDE we can select run from the combo.
![Figure](https://raw.githubusercontent.com/prakdutt/data-dev-learning-labs/master/labs/develop-stream-handler-cisco-csa/assets/images/step15.jpg)

</br></br>
**The Visualising of the data using Zeppelin is described in next section. Please visit next section for details.**
